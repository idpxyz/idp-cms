# å…šæŠ¥å¤´æ¡ - ä¸“é¢˜ç³»ç»Ÿè¯¦ç»†è®¾è®¡æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°å…šæŠ¥å¤´æ¡ä¸“é¢˜ç³»ç»Ÿçš„æŠ€æœ¯æ¶æ„è®¾è®¡ã€æ•°æ®æ¨¡å‹è®¾è®¡ã€æ¥å£è®¾è®¡ã€å‰ç«¯è®¾è®¡ã€ä¸šåŠ¡æµç¨‹è®¾è®¡ç­‰æŠ€æœ¯å®ç°ç»†èŠ‚ã€‚

### è®¾è®¡ç›®æ ‡
- ğŸ¯ **åŠŸèƒ½ç›®æ ‡**: åœ¨ç°æœ‰Wagtail CMSåŸºç¡€ä¸Šï¼Œå¢å¼ºé‡å¤§äº‹ä»¶æ·±åº¦è·Ÿè¸ªèƒ½åŠ›
- ğŸ—ï¸ **æ¶æ„ç›®æ ‡**: ä¸ç°æœ‰ç³»ç»Ÿæ·±åº¦é›†æˆï¼Œå¤ç”¨æˆç†ŸæŠ€æœ¯æ ˆå’Œè®¾è®¡æ¨¡å¼
- ğŸ”’ **å®‰å…¨ç›®æ ‡**: ç»§æ‰¿ç°æœ‰æƒé™ä½“ç³»ï¼Œç¡®ä¿å†…å®¹å®‰å…¨å’Œå®¡æ ¸æµç¨‹
- ğŸ“± **ä½“éªŒç›®æ ‡**: å‚è€ƒChannelæ¨¡æ¿ç³»ç»Ÿï¼Œæä¾›ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒ

### æ ¸å¿ƒåŸåˆ™
```
ä¸“é¢˜ç³»ç»Ÿ = Wagtail CMS çš„åŠŸèƒ½å¢å¼ºæ¨¡å—ï¼ˆéç‹¬ç«‹ç³»ç»Ÿï¼‰
è®¾è®¡åŸåˆ™ = å¤ç”¨ç°æœ‰ + æ¸è¿›å¢å¼º + ä¿æŒä¸€è‡´ + æ˜“ç»´æŠ¤
æŠ€æœ¯é€‰å‹ = ç°æœ‰æŠ€æœ¯æ ˆ + Wagtailé›†æˆ + Channelæ¨¡æ¿æœºåˆ¶å¤ç”¨
```

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„è®¾è®¡

### ä¸“é¢˜æ¨¡æ¿ç³»ç»Ÿæ¶æ„

åŸºäºChannelæ¨¡æ¿ç³»ç»Ÿçš„æˆåŠŸç»éªŒï¼ŒTopicç³»ç»Ÿé‡‡ç”¨å®Œå…¨ç›¸åŒçš„æ¨¡æ¿æ¶æ„ï¼š

```mermaid
graph TD
    A[Topic Model] --> B[template å¤–é”®å­—æ®µ]
    B --> C[TopicTemplate Model]
    C --> D[æ¨¡æ¿æ–‡ä»¶æ˜ å°„]
    D --> E[å‰ç«¯æ¨¡æ¿æ–‡ä»¶]
    E --> F[TopicPageRenderer]
    F --> G[getTopicTemplate å‡½æ•°]
    G --> H[åŠ¨æ€æ¨¡æ¿é€‰æ‹©]
    H --> I[æ¨¡æ¿ç»„ä»¶æ¸²æŸ“]
    
    subgraph "ä¸“é¢˜æ¨¡æ¿ç±»å‹"
        J[DefaultTopicTemplate.tsx]
        K[BreakingTopicTemplate.tsx] 
        L[NationalTopicTemplate.tsx]
        M[TimelineTopicTemplate.tsx]
    end
    
    I --> J
    I --> K
    I --> L
    I --> M
    
    subgraph "æ¨¡æ¿é€‰æ‹©é€»è¾‘"
        N[1. æ•°æ®åº“é…ç½®ä¼˜å…ˆ]
        O[2. æ ‡ç­¾æ˜ å°„å…œåº•]
        P[3. é»˜è®¤æ¨¡æ¿fallback]
    end
    
    G --> N
    N --> O
    O --> P
    
    style A fill:#ff9999,stroke:#333,stroke-width:2px
    style C fill:#ff9999,stroke:#333,stroke-width:2px
    style F fill:#ff9999,stroke:#333,stroke-width:2px
```

### æ¨¡æ¿é€‰æ‹©æµç¨‹å›¾

```mermaid
flowchart TD
    A[ç”¨æˆ·è®¿é—®ä¸“é¢˜é¡µé¢ /topic/slug] --> B[TopicPageRenderer æŸ¥æ‰¾ä¸“é¢˜]
    B --> C{ä¸“é¢˜å­˜åœ¨?}
    C -->|å¦| D[è¿”å›404é¡µé¢]
    C -->|æ˜¯| E[è°ƒç”¨ getTopicTemplate å‡½æ•°]
    
    E --> F{ä¸“é¢˜æ˜¯å¦é…ç½®äº†template?}
    F -->|æ˜¯| G[æ ¹æ® template.file_name é€‰æ‹©]
    F -->|å¦| H[æ ¹æ®ä¸“é¢˜æ ‡ç­¾åŒ¹é…]
    
    G --> I{æ¨¡æ¿æ–‡ä»¶å­˜åœ¨?}
    I -->|æ˜¯| J[åŠ è½½å¯¹åº”æ¨¡æ¿ç»„ä»¶]
    I -->|å¦| K[ä½¿ç”¨é»˜è®¤æ¨¡æ¿]
    
    H --> L{æ ‡ç­¾åŒ¹é…æˆåŠŸ?}
    L -->|æ˜¯| M[åŠ è½½åŒ¹é…çš„æ¨¡æ¿]
    L -->|å¦| K
    
    J --> N[æ¸²æŸ“ä¸“é¢˜é¡µé¢]
    M --> N
    K --> N
    
    style E fill:#ff9999,stroke:#333,stroke-width:2px
    style F fill:#ff9999,stroke:#333,stroke-width:2px
    style G fill:#ff9999,stroke:#333,stroke-width:2px
```

### Channel vs Topic æ¨¡æ¿ç³»ç»Ÿå¯¹æ¯”

```mermaid
graph LR
    subgraph "Channelæ¨¡æ¿ç³»ç»Ÿ (å·²æœ‰)"
        A1[Channel Model] --> B1[template å¤–é”®]
        B1 --> C1[ChannelTemplate]
        C1 --> D1[SocialTemplate.tsx]
        C1 --> D2[TechTemplate.tsx]
        C1 --> D3[DefaultTemplate.tsx]
        
        E1[ChannelPageRenderer] --> F1[getChannelTemplate]
        F1 --> G1[åŠ¨æ€é€‰æ‹©æ¨¡æ¿]
    end
    
    subgraph "Topicæ¨¡æ¿ç³»ç»Ÿ (æ–°å¢)"
        A2[Topic Model] --> B2[template å¤–é”®]
        B2 --> C2[TopicTemplate]
        C2 --> D4[BreakingTopicTemplate.tsx]
        C2 --> D5[NationalTopicTemplate.tsx]
        C2 --> D6[DefaultTopicTemplate.tsx]
        
        E2[TopicPageRenderer] --> F2[getTopicTemplate]
        F2 --> G2[åŠ¨æ€é€‰æ‹©æ¨¡æ¿]
    end
    
    H[ç›¸åŒçš„æ¶æ„æ¨¡å¼<br/>ç›¸åŒçš„æŠ€æœ¯å®ç°<br/>ç›¸åŒçš„ç®¡ç†æ–¹å¼] --> A1
    H --> A2
    
    style H fill:#90EE90,stroke:#333,stroke-width:2px
    style C1 fill:#87CEEB,stroke:#333,stroke-width:2px
    style C2 fill:#ff9999,stroke:#333,stroke-width:2px
```

### æ•´ä½“æ¶æ„å›¾

```mermaid
graph TB
    subgraph "å‰ç«¯å±‚"
        A[ç”¨æˆ·æµè§ˆå™¨] --> B[Next.jsåº”ç”¨]
        B --> C[Reactç»„ä»¶]
        C --> D[ä¸“é¢˜å±•ç¤ºç»„ä»¶]
    end
    
    subgraph "APIç½‘å…³å±‚"
        B --> E[Next.js API Routes]
        E --> F[èº«ä»½è®¤è¯]
        E --> G[è¯·æ±‚ä»£ç†]
        E --> H[ç¼“å­˜æ§åˆ¶]
    end
    
    subgraph "ä¸šåŠ¡æœåŠ¡å±‚"
        G --> I[Django REST API]
        I --> J[ä¸“é¢˜ç®¡ç†æœåŠ¡]
        I --> K[å†…å®¹èšåˆæœåŠ¡]
        I --> L[æƒé™ç®¡ç†æœåŠ¡]
        I --> M[æœç´¢æœåŠ¡]
    end
    
    subgraph "æ•°æ®å±‚"
        J --> N[PostgreSQLä¸»åº“]
        K --> O[PostgreSQLä»åº“]
        L --> P[Redisç¼“å­˜]
        M --> Q[OpenSearch]
    end
    
    subgraph "å¤–éƒ¨ç³»ç»Ÿ"
        R[Wagtail CMS] --> I
        S[æ–‡ç« ç®¡ç†ç³»ç»Ÿ] --> I
        T[ç”¨æˆ·ç³»ç»Ÿ] --> I
    end
    
    style D fill:#ff9999,stroke:#333,stroke-width:2px
    style J fill:#ff9999,stroke:#333,stroke-width:2px
```

### å‰ç«¯æ¨¡æ¿æ–‡ä»¶ç»„ç»‡ç»“æ„

```mermaid
graph TD
    A[sites/app/portal/templates/] --> B[topics/]
    B --> C[DefaultTopicTemplate.tsx]
    B --> D[BreakingTopicTemplate.tsx]
    B --> E[NationalTopicTemplate.tsx]
    B --> F[TimelineTopicTemplate.tsx]
    B --> G[index.ts]
    
    G --> H[getTopicTemplate å‡½æ•°]
    H --> I[æ¨¡æ¿æ˜ å°„è¡¨]
    
    subgraph "æ¨¡æ¿æ˜ å°„é€»è¾‘"
        J["æ•°æ®åº“ä¼˜å…ˆ: topic.template.file_name"]
        K["æ ‡ç­¾æ˜ å°„: {'çªå‘äº‹ä»¶': BreakingTemplate}"]
        L["é»˜è®¤å…œåº•: DefaultTopicTemplate"]
    end
    
    H --> J
    J --> K
    K --> L
    
    subgraph "ç»„ä»¶å¤ç”¨"
        M[TopicStrip.tsx]
        N[TopicCard.tsx]
        O[TopicTimeline.tsx]
        P[TopicMetrics.tsx]
    end
    
    C --> M
    D --> M
    E --> M
    F --> M
    
    style B fill:#ff9999,stroke:#333,stroke-width:2px
    style H fill:#ff9999,stroke:#333,stroke-width:2px
    style M fill:#87CEEB,stroke:#333,stroke-width:2px
```

### æ¨¡æ¿æŠ€æœ¯å®ç°æ¶æ„

```mermaid
graph LR
    subgraph "æ•°æ®å±‚"
        A1[Topic Model] --> A2[template FK]
        A3[TopicTemplate Model] --> A4[file_name]
        A2 --> A3
    end
    
    subgraph "APIå±‚"
        B1[Django REST API] --> B2[Topic Serializer]
        B2 --> B3[åŒ…å« template ä¿¡æ¯]
        A1 --> B1
    end
    
    subgraph "å‰ç«¯è·¯ç”±å±‚"
        C1[/topic/[slug]/page.tsx] --> C2[TopicPageRenderer]
        B3 --> C1
    end
    
    subgraph "æ¨¡æ¿é€‰æ‹©å±‚"
        D1[getTopicTemplate å‡½æ•°] --> D2{æ•°æ®åº“é…ç½®?}
        D2 -->|æ˜¯| D3[template.file_name]
        D2 -->|å¦| D4[æ ‡ç­¾æ˜ å°„]
        D3 --> D5[åŠ¨æ€ import()]
        D4 --> D5
        C2 --> D1
    end
    
    subgraph "æ¨¡æ¿æ¸²æŸ“å±‚"
        E1[DefaultTopicTemplate]
        E2[BreakingTopicTemplate]  
        E3[NationalTopicTemplate]
        E4[TimelineTopicTemplate]
        
        D5 --> E1
        D5 --> E2
        D5 --> E3
        D5 --> E4
    end
    
    subgraph "ç»„ä»¶å±‚"
        F1[TopicStrip] --> F2[ä¸“é¢˜æ–‡ç« åˆ—è¡¨]
        F3[TopicTimeline] --> F4[äº‹ä»¶æ—¶é—´çº¿]
        F5[TopicMetrics] --> F6[ä¸“é¢˜æ•°æ®ç»Ÿè®¡]
        
        E1 --> F1
        E2 --> F1
        E3 --> F3
        E4 --> F3
    end
    
    style D1 fill:#ff9999,stroke:#333,stroke-width:2px
    style D2 fill:#ff9999,stroke:#333,stroke-width:2px
    style E2 fill:#ffcccc,stroke:#333,stroke-width:2px
```

### æ ¸å¿ƒç»„ä»¶æ¶æ„

#### 1. å‰ç«¯æ¶æ„ï¼ˆNext.js + Reactï¼‰

```typescript
// å‰ç«¯æ¶æ„åˆ†å±‚
interface TopicSystemArchitecture {
    // é¡µé¢å±‚
    pages: {
        '/topic/[slug]': TopicDetailPage;
        '/topics': TopicListPage;
        '/admin/topics': TopicManagementPage;
    };
    
    // ç»„ä»¶å±‚
    components: {
        display: TopicShowcase | TopicCard | TopicTimeline;
        forms: TopicEditor | TopicPublisher;
        layout: TopicLayout | TopicNavigation;
    };
    
    // æœåŠ¡å±‚
    services: {
        api: TopicService | ArticleService;
        auth: AuthService;
        cache: CacheService;
    };
    
    // çŠ¶æ€ç®¡ç†
    state: {
        global: TopicStore;
        local: useTopicState;
    };
}
```

#### 2. åç«¯æ¶æ„ï¼ˆDjango + DRFï¼‰

```python
# åç«¯æœåŠ¡æ¶æ„
class TopicSystemServices:
    """ä¸“é¢˜ç³»ç»Ÿåç«¯æœåŠ¡æ¶æ„"""
    
    # æ ¸å¿ƒæœåŠ¡
    topic_service = TopicManagementService()       # ä¸“é¢˜ç®¡ç†
    content_service = ContentAggregationService()  # å†…å®¹èšåˆ
    timeline_service = TopicTimelineService()      # æ—¶é—´çº¿ç®¡ç†
    publish_service = TopicPublishingService()     # å‘å¸ƒç®¡ç†
    
    # æ”¯æ’‘æœåŠ¡
    auth_service = AuthenticationService()         # è®¤è¯æˆæƒ
    cache_service = CacheManagementService()       # ç¼“å­˜ç®¡ç†
    search_service = SearchService()               # æœç´¢æœåŠ¡
    notification_service = NotificationService()   # é€šçŸ¥æœåŠ¡
    
    # å¤–éƒ¨é›†æˆ
    cms_integration = WagtailIntegration()         # CMSé›†æˆ
    elasticsearch_integration = ESIntegration()    # æœç´¢é›†æˆ
```

### æŠ€æœ¯æ ˆé€‰å‹

| å±‚æ¬¡ | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ | ç”¨é€”è¯´æ˜ |
|------|----------|------|----------|
| **å‰ç«¯æ¡†æ¶** | Next.js | 14.x | æœåŠ¡ç«¯æ¸²æŸ“ã€è·¯ç”±ç®¡ç† |
| **UIåº“** | React | 18.x | ç»„ä»¶åŒ–å¼€å‘ |
| **æ ·å¼** | Tailwind CSS | 3.x | åŸå­åŒ–CSSæ¡†æ¶ |
| **çŠ¶æ€ç®¡ç†** | Zustand | 4.x | è½»é‡çº§çŠ¶æ€ç®¡ç† |
| **åç«¯æ¡†æ¶** | Django | 4.x | Webæ¡†æ¶ |
| **APIæ¡†æ¶** | DRF | 3.x | REST APIå¼€å‘ |
| **æ•°æ®åº“** | PostgreSQL | 15.x | ä¸»æ•°æ®å­˜å‚¨ |
| **ç¼“å­˜** | Redis | 7.x | ç¼“å­˜å’Œä¼šè¯å­˜å‚¨ |
| **æœç´¢å¼•æ“** | OpenSearch | 2.x | å…¨æ–‡æ£€ç´¢ |
| **ä»»åŠ¡é˜Ÿåˆ—** | Celery | 5.x | å¼‚æ­¥ä»»åŠ¡å¤„ç† |

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ•°æ®åº“ERå…³ç³»å›¾

```mermaid
erDiagram
    Site ||--o{ Topic : "belongs to"
    Site ||--o{ Channel : "belongs to"
    Site ||--o{ Category : "belongs to"
    
    TopicTemplate ||--o{ Topic : "has template"
    
    Topic ||--o{ TopicTimeline : "has events"
    Topic ||--o{ TopicMetrics : "has metrics"
    Topic }o--o{ ArticlePage : "includes"
    Topic }o--o{ TopicTag : "tagged by"
    
    Channel ||--o{ ArticlePage : "contains"
    Category }o--o{ ArticlePage : "categorized by"
    
    ArticlePage ||--o{ ArticleMetrics : "has metrics"
    ArticlePage }o--|| User : "authored by"
    
    Topic {
        bigint id PK
        varchar title
        varchar slug UK
        text summary
        varchar importance_level
        varchar status
        timestamp start_date
        timestamp end_date
        json key_moments
        boolean is_active
        boolean is_featured  
        boolean is_breaking
        integer priority_weight
        text related_departments
        json official_links
        timestamp created_at
        timestamp updated_at
        bigint site_id FK
        bigint template_id FK
    }
    
    TopicTemplate {
        bigint id PK
        varchar name
        varchar slug UK
        varchar file_name
        text description
        boolean is_active
        boolean is_default
        integer order
        timestamp created_at
        timestamp updated_at
    }
    
    TopicTimeline {
        bigint id PK
        bigint topic_id FK
        timestamp event_time
        varchar title
        text description
        varchar event_type
        boolean is_important
        json metadata
        timestamp created_at
    }
    
    TopicMetrics {
        bigint id PK
        bigint topic_id FK
        date date
        integer page_views
        integer unique_visitors
        float avg_time_on_page
        integer bounce_rate
        integer social_shares
        json detailed_metrics
    }
    
    ArticlePage {
        bigint id PK
        varchar title
        text body
        varchar slug
        timestamp first_published_at
        timestamp last_published_at
        boolean is_breaking_news
        integer topic_importance
        bigint channel_id FK
        bigint author_id FK
    }
```

### æ ¸å¿ƒæ•°æ®æ¨¡å‹è®¾è®¡

#### 1. Topic ä¸“é¢˜æ¨¡å‹

```python
class Topic(ClusterableModel):
    """é‡å¤§äº‹ä»¶ä¸“é¢˜æ¨¡å‹"""
    
    # === åŸºæœ¬ä¿¡æ¯ ===
    title = models.CharField(
        max_length=128, 
        verbose_name="ä¸“é¢˜æ ‡é¢˜",
        help_text="ç®€æ´æ˜ç¡®çš„ä¸“é¢˜æ ‡é¢˜ï¼Œå¦‚ï¼šå››å·6.8çº§åœ°éœ‡æ•‘æ´"
    )
    slug = models.SlugField(
        unique=True, 
        max_length=150,
        verbose_name="URLæ ‡è¯†",
        help_text="ç”¨äºURLçš„å”¯ä¸€æ ‡è¯†ç¬¦"
    )
    summary = models.TextField(
        blank=True,
        verbose_name="ä¸“é¢˜æ‘˜è¦", 
        help_text="ä¸“é¢˜çš„ç®€è¦æè¿°ï¼Œç”¨äºSEOå’Œåˆ†äº«"
    )
    cover_image = models.ForeignKey(
        'wagtailimages.Image',
        null=True, blank=True,
        on_delete=models.SET_NULL,
        related_name='+',
        verbose_name="å°é¢å›¾ç‰‡"
    )
    
    # === ä¸“é¢˜åˆ†ç±» ===
    # æ³¨æ„ï¼šç§»é™¤å›ºå®šçš„topic_typeå­—æ®µï¼Œä½¿ç”¨çµæ´»çš„æ ‡ç­¾ç³»ç»Ÿ
    # ç®¡ç†å‘˜å¯é€šè¿‡tagså­—æ®µçµæ´»å®šä¹‰ä¸“é¢˜ç±»å‹ï¼šå›½åº†åº†å…¸ã€çªå‘ç¾å®³ã€ä½“è‚²èµ›äº‹ç­‰
    # è¿™æ ·é¿å…äº†åˆ†ç±»è¾¹ç•Œæ¨¡ç³Šçš„é—®é¢˜ï¼Œæ›´ç¬¦åˆWagtail Snippetçš„ç®€æ´åŸåˆ™
    
    IMPORTANCE_LEVELS = [
        ('national', 'å›½å®¶çº§'),      # å…¨å›½é‡å¤§å½±å“
        ('major', 'é‡å¤§çº§'),         # é‡è¦ç¤¾ä¼šå½±å“  
        ('regional', 'åŒºåŸŸçº§'),      # åŒºåŸŸæ€§å½±å“
        ('specialized', 'ä¸“é—¨çº§'),   # ç‰¹å®šé¢†åŸŸå½±å“
    ]
    importance_level = models.CharField(
        max_length=16, 
        choices=IMPORTANCE_LEVELS,
        default='major',
        verbose_name="é‡è¦ç¨‹åº¦"
    )
    
    STATUS_CHOICES = [
        ('upcoming', 'å³å°†å¼€å§‹'),     # é¢„å‘Šé˜¶æ®µ
        ('ongoing', 'æ­£åœ¨è¿›è¡Œ'),      # è¿›è¡Œä¸­
        ('concluded', 'å·²ç»“æŸ'),      # ç»“æŸä½†ä»å…³æ³¨
        ('archived', 'å·²å½’æ¡£'),       # å®Œå…¨ç»“æŸ
        ('memorial', 'çºªå¿µå›é¡¾'),     # å‘¨å¹´çºªå¿µç­‰
    ]
    status = models.CharField(
        max_length=16, 
        choices=STATUS_CHOICES,
        default='upcoming',
        verbose_name="ä¸“é¢˜çŠ¶æ€"
    )
    
    # === æ—¶é—´ç®¡ç† ===
    start_date = models.DateTimeField(
        null=True, blank=True,
        verbose_name="äº‹ä»¶å¼€å§‹æ—¶é—´",
        help_text="äº‹ä»¶å®é™…å¼€å§‹çš„æ—¶é—´"
    )
    end_date = models.DateTimeField(
        null=True, blank=True,
        verbose_name="äº‹ä»¶ç»“æŸæ—¶é—´", 
        help_text="äº‹ä»¶å®é™…ç»“æŸçš„æ—¶é—´"
    )
    key_moments = models.JSONField(
        default=list, blank=True,
        verbose_name="å…³é”®æ—¶é—´ç‚¹",
        help_text="äº‹ä»¶å‘å±•è¿‡ç¨‹ä¸­çš„å…³é”®æ—¶é—´èŠ‚ç‚¹"
    )
    
    # === æ§åˆ¶å­—æ®µ ===
    is_active = models.BooleanField(
        default=True,
        verbose_name="æ˜¯å¦å¯ç”¨",
        help_text="æ§åˆ¶ä¸“é¢˜æ˜¯å¦åœ¨å‰å°æ˜¾ç¤º"
    )
    is_featured = models.BooleanField(
        default=False,
        verbose_name="æ˜¯å¦æ¨è",
        help_text="æ˜¯å¦åœ¨é¦–é¡µç­‰é‡è¦ä½ç½®æ¨èå±•ç¤º"
    )
    is_breaking = models.BooleanField(
        default=False,
        verbose_name="æ˜¯å¦çªå‘é‡å¤§äº‹ä»¶",
        help_text="çªå‘äº‹ä»¶ä¼šè·å¾—æœ€é«˜å±•ç¤ºä¼˜å…ˆçº§"
    )
    priority_weight = models.IntegerField(
        default=100,
        verbose_name="ä¼˜å…ˆæƒé‡",
        help_text="æ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼ŒèŒƒå›´ï¼š1-2000"
    )
    
    # === å¤šç«™ç‚¹æ”¯æŒ ===
    sites = models.ManyToManyField(
        'wagtailcore.Site',
        blank=True,
        verbose_name="å…³è”ç«™ç‚¹"
    )
    
    # === æ‰©å±•ä¿¡æ¯ ===
    related_departments = models.TextField(
        blank=True,
        verbose_name="ç›¸å…³éƒ¨é—¨",
        help_text="å¦‚ï¼šå›½é˜²éƒ¨ã€åº”æ€¥ç®¡ç†éƒ¨ã€å¤–äº¤éƒ¨ç­‰"
    )
    official_links = models.JSONField(
        default=list, blank=True,
        verbose_name="å®˜æ–¹é“¾æ¥",
        help_text="ç›¸å…³çš„å®˜æ–¹ç½‘ç«™ã€ç›´æ’­é“¾æ¥ç­‰"
    )
    
    # === æ¨¡æ¿ç³»ç»Ÿ ===ï¼ˆå‚è€ƒChannelæ¨¡æ¿è®¾è®¡ï¼‰
    template = models.ForeignKey(
        'TopicTemplate',
        on_delete=models.SET_NULL,
        null=True, blank=True,
        verbose_name="ä¸“é¢˜æ¨¡æ¿",
        help_text="é€‰æ‹©ä¸“é¢˜çš„æ˜¾ç¤ºæ¨¡æ¿ï¼Œå¦‚çªå‘äº‹ä»¶æ¨¡æ¿ã€å›½å®¶çº§ä¸“é¢˜æ¨¡æ¿ç­‰"
    )
    
    # === æ ‡ç­¾ç³»ç»Ÿ ===
    tags = ClusterTaggableManager(
        through='news.TopicTag',
        blank=True,
        verbose_name="ä¸“é¢˜æ ‡ç­¾"
    )
    
    # === æ—¶é—´æˆ³ ===
    created_at = models.DateTimeField(
        auto_now_add=True,
        verbose_name="åˆ›å»ºæ—¶é—´"
    )
    updated_at = models.DateTimeField(
        auto_now=True,
        verbose_name="æ›´æ–°æ—¶é—´"
    )
    
    class Meta:
        verbose_name = "é‡å¤§äº‹ä»¶ä¸“é¢˜"
        verbose_name_plural = "é‡å¤§äº‹ä»¶ä¸“é¢˜"
        ordering = [
            '-is_breaking',        # çªå‘äº‹ä»¶ä¼˜å…ˆ
            '-priority_weight',    # æƒé‡ä¼˜å…ˆ
            '-is_featured',        # æ¨èä¼˜å…ˆ
            '-start_date',         # æ—¶é—´ä¼˜å…ˆ
        ]
        indexes = [
            models.Index(fields=['slug']),
            models.Index(fields=['importance_level', 'status']), 
            models.Index(fields=['status', 'is_active']),
            models.Index(fields=['-priority_weight', '-created_at']),
            models.Index(fields=['is_breaking', 'is_featured']),
            models.Index(fields=['template', 'is_active']),
        ]


# ä¸“é¢˜æ¨¡æ¿æ¨¡å‹ï¼ˆå‚è€ƒChannelæ¨¡æ¿ç³»ç»Ÿï¼‰
class TopicTemplate(ClusterableModel):
    """ä¸“é¢˜æ¨¡æ¿ç®¡ç† - ç±»ä¼¼ChannelTemplateçš„è®¾è®¡æ¨¡å¼"""
    
    name = models.CharField(
        max_length=100,
        verbose_name="æ¨¡æ¿åç§°",
        help_text="å¦‚ï¼šçªå‘äº‹ä»¶ä¸“é¢˜æ¨¡æ¿"
    )
    
    slug = models.SlugField(
        unique=True,
        verbose_name="æ¨¡æ¿æ ‡è¯†",
        help_text="å¦‚ï¼šbreakingï¼Œç”¨äºåŒ¹é…ä¸“é¢˜æ ‡ç­¾"
    )
    
    file_name = models.CharField(
        max_length=100,
        verbose_name="æ¨¡æ¿æ–‡ä»¶å",
        help_text="å¦‚ï¼šBreakingTopicTemplate.tsx"
    )
    
    description = models.TextField(
        blank=True,
        verbose_name="æè¿°"
    )
    
    is_active = models.BooleanField(
        default=True,
        verbose_name="æ˜¯å¦å¯ç”¨"
    )
    
    is_default = models.BooleanField(
        default=False,
        verbose_name="æ˜¯å¦ä¸ºé»˜è®¤æ¨¡æ¿"
    )
    
    order = models.IntegerField(
        default=0,
        verbose_name="æ’åº"
    )
    
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        verbose_name = "ä¸“é¢˜æ¨¡æ¿"
        verbose_name_plural = "ä¸“é¢˜æ¨¡æ¿"
        ordering = ['order', 'name']
    
    def __str__(self):
        return self.name
    
    @classmethod
    def get_available_templates(cls):
        """è·å–å¯ç”¨æ¨¡æ¿"""
        return cls.objects.filter(is_active=True).order_by('order', 'name')
    
    @classmethod
    def get_default_template(cls):
        """è·å–é»˜è®¤æ¨¡æ¿"""
        return cls.objects.filter(is_default=True, is_active=True).first()


# ä¸“é¢˜æ—¶é—´çº¿æ¨¡å‹
class TopicTimeline(models.Model):
    """ä¸“é¢˜æ—¶é—´çº¿ - è®°å½•é‡å¤§äº‹ä»¶å‘å±•è¿‡ç¨‹"""
    
    topic = models.ForeignKey(
        Topic,
        on_delete=models.CASCADE,
        related_name='timeline_events',
        verbose_name="æ‰€å±ä¸“é¢˜"
    )
    
    event_time = models.DateTimeField(
        verbose_name="äº‹ä»¶æ—¶é—´",
        help_text="äº‹ä»¶å‘ç”Ÿçš„å…·ä½“æ—¶é—´"
    )
    
    title = models.CharField(
        max_length=200,
        verbose_name="äº‹ä»¶æ ‡é¢˜",
        help_text="ç®€æ´æè¿°äº‹ä»¶å†…å®¹"
    )
    
    description = models.TextField(
        verbose_name="äº‹ä»¶æè¿°",
        help_text="è¯¦ç»†æè¿°äº‹ä»¶å†…å®¹å’Œå½±å“"
    )
    
    EVENT_TYPES = [
        ('major_development', 'é‡å¤§è¿›å±•'),
        ('latest_update', 'æœ€æ–°æ¶ˆæ¯'),
        ('official_announcement', 'å®˜æ–¹å‘å¸ƒ'),
        ('rescue_operation', 'æ•‘æ´è¡ŒåŠ¨'),
        ('ceremony_segment', 'ä»ªå¼ç¯èŠ‚'),
        ('policy_release', 'æ”¿ç­–å‘å¸ƒ'),
        ('international_response', 'å›½é™…åå“'),
    ]
    event_type = models.CharField(
        max_length=32,
        choices=EVENT_TYPES,
        verbose_name="äº‹ä»¶ç±»å‹"
    )
    
    is_important = models.BooleanField(
        default=False,
        verbose_name="æ˜¯å¦é‡è¦èŠ‚ç‚¹",
        help_text="é‡è¦èŠ‚ç‚¹ä¼šåœ¨æ—¶é—´çº¿ä¸­çªå‡ºæ˜¾ç¤º"
    )
    
    source_url = models.URLField(
        blank=True,
        verbose_name="ä¿¡æ¯æ¥æº",
        help_text="ç›¸å…³æ–°é—»æŠ¥é“æˆ–å®˜æ–¹å‘å¸ƒçš„é“¾æ¥"
    )
    
    metadata = models.JSONField(
        default=dict, blank=True,
        verbose_name="æ‰©å±•æ•°æ®",
        help_text="å­˜å‚¨é¢å¤–çš„ç»“æ„åŒ–æ•°æ®"
    )
    
    created_at = models.DateTimeField(
        auto_now_add=True,
        verbose_name="åˆ›å»ºæ—¶é—´"
    )
    
    class Meta:
        ordering = ['-event_time']
        verbose_name = "ä¸“é¢˜æ—¶é—´çº¿"
        verbose_name_plural = "ä¸“é¢˜æ—¶é—´çº¿"
        indexes = [
            models.Index(fields=['topic', '-event_time']),
            models.Index(fields=['event_type', 'is_important']),
        ]
```

#### 2. æ•°æ®è¡¨ç´¢å¼•ä¼˜åŒ–ç­–ç•¥

```sql
-- ä¸“é¢˜ç›¸å…³ç´¢å¼•ä¼˜åŒ–
CREATE INDEX CONCURRENTLY idx_topic_active_priority ON news_topic 
    (is_active, priority_weight DESC, created_at DESC);

CREATE INDEX CONCURRENTLY idx_topic_status_template ON news_topic 
    (status, template_id) WHERE is_active = true;

CREATE INDEX CONCURRENTLY idx_topic_breaking_featured ON news_topic 
    (is_breaking DESC, is_featured DESC) WHERE is_active = true;

-- æ—¶é—´çº¿ç›¸å…³ç´¢å¼•
CREATE INDEX CONCURRENTLY idx_timeline_topic_time ON news_topictimeline 
    (topic_id, event_time DESC);

CREATE INDEX CONCURRENTLY idx_timeline_important ON news_topictimeline 
    (is_important, event_time DESC) WHERE is_important = true;

-- æ–‡ç« ä¸“é¢˜å…³è”ç´¢å¼•
CREATE INDEX CONCURRENTLY idx_article_topics ON news_articlepage_topics 
    (topic_id, articlepage_id);
```

## ğŸ”Œ APIæ¥å£è®¾è®¡

### RESTful APIæ¶æ„

#### APIè®¾è®¡åŸåˆ™
- **RESTful**: éµå¾ªRESTæ¶æ„é£æ ¼
- **ç‰ˆæœ¬åŒ–**: æ”¯æŒAPIç‰ˆæœ¬ç®¡ç†
- **åˆ†é¡µ**: å¤§æ•°æ®é›†åˆçš„åˆ†é¡µå¤„ç†
- **è¿‡æ»¤**: ä¸°å¯Œçš„æŸ¥è¯¢å’Œè¿‡æ»¤åŠŸèƒ½
- **ç¼“å­˜**: åˆç†çš„HTTPç¼“å­˜ç­–ç•¥
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼

### æ ¸å¿ƒAPIç«¯ç‚¹è®¾è®¡

#### 1. ä¸“é¢˜ç®¡ç†API

```python
# ä¸“é¢˜åˆ—è¡¨API
@api_view(['GET'])
@cache_page(300)  # 5åˆ†é’Ÿç¼“å­˜
def topic_list(request):
    """
    è·å–ä¸“é¢˜åˆ—è¡¨
    
    æŸ¥è¯¢å‚æ•°:
- type: ä¸“é¢˜ç±»å‹ç­›é€‰
- status: çŠ¶æ€ç­›é€‰  
- importance: é‡è¦ç¨‹åº¦ç­›é€‰
    - is_breaking: æ˜¯å¦çªå‘äº‹ä»¶
    - is_featured: æ˜¯å¦æ¨è
    - page: é¡µç 
    - page_size: æ¯é¡µæ•°é‡(é»˜è®¤20ï¼Œæœ€å¤§100)
    - ordering: æ’åºæ–¹å¼
    
    è¿”å›æ ¼å¼:
    {
        "count": æ€»æ•°é‡,
        "next": "ä¸‹ä¸€é¡µURL",
        "previous": "ä¸Šä¸€é¡µURL", 
        "results": [ä¸“é¢˜å¯¹è±¡åˆ—è¡¨]
    }
    """
    
    # æŸ¥è¯¢è¿‡æ»¤
    queryset = Topic.objects.filter(is_active=True)
    
    # å‚æ•°è¿‡æ»¤ - ä½¿ç”¨æ ‡ç­¾å’Œæ¨¡æ¿è¿›è¡Œè¿‡æ»¤
    template_slug = request.GET.get('template')
    if template_slug:
        queryset = queryset.filter(template__slug=template_slug)
    
    tags = request.GET.get('tags')
    if tags:
        tag_list = tags.split(',')
        queryset = queryset.filter(tags__name__in=tag_list).distinct()
    
    status = request.GET.get('status')
    if status:
        queryset = queryset.filter(status=status)
        
    importance = request.GET.get('importance')
    if importance:
        queryset = queryset.filter(importance_level=importance)
        
    is_breaking = request.GET.get('is_breaking')
    if is_breaking:
        queryset = queryset.filter(is_breaking=True)
        
    is_featured = request.GET.get('is_featured') 
    if is_featured:
        queryset = queryset.filter(is_featured=True)
    
    # æ’åº
    ordering = request.GET.get('ordering', '-created_at')
    allowed_orderings = [
        'created_at', '-created_at',
        'start_date', '-start_date',
        'priority_weight', '-priority_weight',
        'title', '-title'
    ]
    if ordering in allowed_orderings:
        queryset = queryset.order_by(ordering)
    
    # åˆ†é¡µ
    paginator = PageNumberPagination()
    paginator.page_size_query_param = 'page_size'
    paginator.page_size = 20
    paginator.max_page_size = 100
    
    page = paginator.paginate_queryset(queryset, request)
    serializer = TopicListSerializer(page, many=True)
    
    return paginator.get_paginated_response(serializer.data)
```

### APIå“åº”æ ¼å¼è§„èŒƒ

#### 1. æˆåŠŸå“åº”æ ¼å¼

```json
{
    "success": true,
    "data": {
        "id": 1,
        "title": "å››å·6.8çº§åœ°éœ‡æ•‘æ´ä¸“é¢˜",
        "slug": "sichuan-earthquake-2024",
        "template": {
            "name": "çªå‘äº‹ä»¶ä¸“é¢˜æ¨¡æ¿",
            "slug": "breaking",
            "file_name": "BreakingTopicTemplate.tsx"
        },
        "importance_level": "national",
        "status": "ongoing",
        "is_breaking": true,
        "priority_weight": 2000,
        "tags": ["çªå‘äº‹ä»¶", "è‡ªç„¶ç¾å®³", "åœ°éœ‡"],
        "start_date": "2024-09-15T14:30:00Z",
        "end_date": null,
        "cover_image": {
            "url": "/media/images/earthquake-cover.jpg",
            "alt": "åœ°éœ‡æ•‘æ´ç°åœº"
        },
        "summary": "å››å·å‘ç”Ÿ6.8çº§åœ°éœ‡ï¼Œå„æ–¹æ•‘æ´åŠ›é‡ç´§æ€¥å‡ºåŠ¨...",
        "articles_count": 25,
        "created_at": "2024-09-15T14:45:00Z",
        "updated_at": "2024-09-15T18:30:00Z"
    },
    "meta": {
        "total_count": 1,
        "page": 1,
        "page_size": 20,
        "has_next": false
    }
}
```

#### 2. é”™è¯¯å“åº”æ ¼å¼

```json
{
    "success": false,
    "error": {
        "code": "TOPIC_NOT_FOUND",
        "message": "æŒ‡å®šçš„ä¸“é¢˜ä¸å­˜åœ¨",
        "details": {
            "slug": "invalid-topic-slug"
        }
    },
    "meta": {
        "timestamp": "2024-09-15T18:30:00Z",
        "request_id": "req_123456789"
    }
}
```

## ğŸ¨ å‰ç«¯UIè®¾è®¡

### å“åº”å¼è®¾è®¡æ¶æ„

#### è®¾è®¡ç†å¿µ
- **å†…å®¹è‡³ä¸Š**: çªå‡ºä¸“é¢˜å†…å®¹ï¼Œå‡å°‘å¹²æ‰°å…ƒç´ 
- **å±‚æ¬¡æ¸…æ™°**: ä¿¡æ¯æ¶æ„æ¸…æ™°ï¼Œç”¨æˆ·èƒ½å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€å†…å®¹
- **æƒ…æ„ŸåŒ–è®¾è®¡**: æ ¹æ®ä¸“é¢˜ç±»å‹é‡‡ç”¨ä¸åŒçš„è§†è§‰é£æ ¼
- **æ— éšœç¢è®¿é—®**: ç¬¦åˆWCAG 2.1 AAæ ‡å‡†çš„æ— éšœç¢è®¾è®¡

#### å“åº”å¼æ–­ç‚¹ç­–ç•¥

```css
/* å“åº”å¼æ–­ç‚¹å®šä¹‰ */
:root {
  --breakpoint-xs: 0;
  --breakpoint-sm: 640px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 1024px;
  --breakpoint-xl: 1280px;
  --breakpoint-2xl: 1536px;
}

/* ä¸“é¢˜é¡µé¢å¸ƒå±€ */
.topic-layout {
  display: grid;
  gap: 2rem;
  
  /* ç§»åŠ¨ç«¯ï¼šå•åˆ—å¸ƒå±€ */
  grid-template-columns: 1fr;
  
  /* å¹³æ¿ç«¯ï¼šä¸»å†…å®¹ + ä¾§æ  */
  @media (min-width: 768px) {
    grid-template-columns: 1fr 320px;
  }
  
  /* æ¡Œé¢ç«¯ï¼šå¢åŠ è¾¹è· */
  @media (min-width: 1024px) {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
  }
}
```

### ä¸“é¢˜æ¨¡æ¿å·®å¼‚åŒ–è®¾è®¡æ¶æ„

```mermaid
graph TD
    A[ä¸“é¢˜é¡µé¢è¯·æ±‚] --> B[getTopicTemplate é€‰æ‹©]
    
    B --> C[DefaultTopicTemplate]
    B --> D[BreakingTopicTemplate]
    B --> E[NationalTopicTemplate]
    B --> F[TimelineTopicTemplate]
    
    subgraph "é»˜è®¤æ¨¡æ¿è®¾è®¡"
        C --> C1[ç®€æ´å¸ƒå±€]
        C --> C2[æ ‡å‡†ä¸“é¢˜å¤´éƒ¨]
        C --> C3[æ–‡ç« åˆ—è¡¨å±•ç¤º]
        C --> C4[ä¾§è¾¹æ æ¨è]
    end
    
    subgraph "çªå‘äº‹ä»¶æ¨¡æ¿"
        D --> D1[çº¢è‰²è­¦ç¤ºä¸»é¢˜]
        D --> D2[åŠ¨æ€æ•ˆæœå…ƒç´ ]
        D --> D3[å®æ—¶æ›´æ–°æ ‡è¯†]
        D --> D4[ç´§æ€¥ä¿¡æ¯çªå‡º]
        D --> D5[å¿«é€Ÿä¿¡æ¯å¡ç‰‡]
    end
    
    subgraph "å›½å®¶çº§æ¨¡æ¿"
        E --> E1[åº„é‡çº¢é‡‘ä¸»é¢˜]
        E --> E2[è‹±é›„æ¨ªå¹…è®¾è®¡]
        E --> E3[å¤šåª’ä½“å±•ç¤º]
        E --> E4[æƒå¨æ ‡è¯†çªå‡º]
        E --> E5[å®˜æ–¹ä¿¡æ¯ä¼˜å…ˆ]
    end
    
    subgraph "æ—¶é—´çº¿æ¨¡æ¿"
        F --> F1[å‚ç›´æ—¶é—´è½´]
        F --> F2[å…³é”®èŠ‚ç‚¹é«˜äº®]
        F --> F3[äº‹ä»¶è¯¦æƒ…å±•å¼€]
        F --> F4[å†å²å›é¡¾åŠŸèƒ½]
        F --> F5[è¿›åº¦æŒ‡ç¤ºå™¨]
    end
    
    subgraph "å…±äº«ç»„ä»¶å¤ç”¨"
        G1[TopicStrip - æ–‡ç« åˆ—è¡¨]
        G2[TopicCard - ä¸“é¢˜å¡ç‰‡]
        G3[TopicMetrics - æ•°æ®ç»Ÿè®¡]
        G4[TopicSidebar - ä¾§è¾¹æ ]
    end
    
    C1 --> G1
    D3 --> G1
    E3 --> G1
    F3 --> G1
    
    style D fill:#ff9999,stroke:#333,stroke-width:3px
    style D1 fill:#ffcccc,stroke:#333,stroke-width:2px
    style E fill:#ffdf00,stroke:#333,stroke-width:3px
    style E1 fill:#fff5cc,stroke:#333,stroke-width:2px
```

### æ¨¡æ¿è§†è§‰å·®å¼‚åŒ–è®¾è®¡

```mermaid
graph LR
    subgraph "è§†è§‰è®¾è®¡å±‚æ¬¡"
        A1[è‰²å½©ä¸»é¢˜] --> B1[å¸ƒå±€ç»“æ„]
        B1 --> C1[äº¤äº’åŠ¨æ•ˆ]
        C1 --> D1[ä¿¡æ¯å±‚çº§]
    end
    
    subgraph "DefaultTemplate"
        A2[è“ç°ä¸­æ€§è‰²è°ƒ]
        B2[ç»å…¸ä¸‰æ å¸ƒå±€]
        C2[è½»å¾®æ‚¬åœæ•ˆæœ]
        D2[å‡è¡¡ä¿¡æ¯åˆ†å¸ƒ]
    end
    
    subgraph "BreakingTemplate"
        A3[çº¢è‰²è­¦ç¤ºè‰²è°ƒ]
        B3[çªå‡ºå¤´éƒ¨åŒºåŸŸ]
        C3[è„‰å†²åŠ¨ç”»æ•ˆæœ]
        D3[é‡è¦ä¿¡æ¯å‰ç½®]
    end
    
    subgraph "NationalTemplate"
        A4[çº¢é‡‘åº„é‡é…è‰²]
        B4[å®½å±è‹±é›„å¸ƒå±€]
        C4[æ¸å˜è¿‡æ¸¡æ•ˆæœ]
        D4[æƒå¨ä¿¡æ¯çªå‡º]
    end
    
    subgraph "TimelineTemplate"
        A5[è“ç»¿æ—¶é—´ä¸»é¢˜]
        B5[å‚ç›´æ—¶é—´è½´å¸ƒå±€]
        C5[å±•å¼€æ”¶èµ·åŠ¨ç”»]
        D5[æ—¶é—´èŠ‚ç‚¹åˆ†å±‚]
    end
    
    A1 --> A2
    A1 --> A3  
    A1 --> A4
    A1 --> A5
    
    B1 --> B2
    B1 --> B3
    B1 --> B4
    B1 --> B5
    
    C1 --> C2
    C1 --> C3
    C1 --> C4
    C1 --> C5
    
    D1 --> D2
    D1 --> D3
    D1 --> D4
    D1 --> D5
    
    style A3 fill:#ff9999,stroke:#333,stroke-width:2px
    style B3 fill:#ff9999,stroke:#333,stroke-width:2px
    style C3 fill:#ff9999,stroke:#333,stroke-width:2px
    style D3 fill:#ff9999,stroke:#333,stroke-width:2px
```

### æ ¸å¿ƒUIç»„ä»¶è®¾è®¡

#### TopicCard ä¸“é¢˜å¡ç‰‡ç»„ä»¶

```tsx
interface TopicCardProps {
  topic: Topic;
  variant?: 'default' | 'featured' | 'breaking' | 'timeline';
  size?: 'sm' | 'md' | 'lg';
  showMetrics?: boolean;
}

const TopicCard: React.FC<TopicCardProps> = ({
  topic,
  variant = 'default',
  size = 'md',
  showMetrics = false
}) => {
  const cardStyles = {
    default: 'bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md',
    featured: 'bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl shadow-lg',
    breaking: 'bg-red-50 border-2 border-red-200 rounded-lg shadow-md animate-pulse',
    timeline: 'bg-gray-50 border-l-4 border-blue-500 rounded-r-lg'
  };

  // æ ¹æ®ä¸“é¢˜æ ‡ç­¾åŠ¨æ€è·å–å›¾æ ‡
  const getTopicIcon = (topic) => {
    const tagIcons = {
      'å›½åº†åº†å…¸': 'ğŸŠ', 'å»ºå…šèŠ‚': 'ğŸŠ', 'å›½å®¶åº†å…¸': 'ğŸŠ',
      'çªå‘äº‹ä»¶': 'ğŸš¨', 'åœ°éœ‡': 'ğŸš¨', 'è‡ªç„¶ç¾å®³': 'ğŸš¨',
      'æ”¿æ²»äº‹ä»¶': 'ğŸ›ï¸', 'ä¸¤ä¼š': 'ğŸ›ï¸', 'é‡è¦ä¼šè®®': 'ğŸ›ï¸',
      'å›½é™…äº‹åŠ¡': 'ğŸŒ', 'å¤–äº¤è®¿é—®': 'ğŸŒ', 'å›½é™…ä¼šè®®': 'ğŸŒ',
      'ä½“è‚²èµ›äº‹': 'ğŸ†', 'å¥¥è¿ä¼š': 'ğŸ†', 'ä¸–ç•Œæ¯': 'ğŸ†',
      'ç§‘æŠ€æˆå°±': 'ğŸš€', 'èˆªå¤©å‘å°„': 'ğŸš€', 'é‡å¤§çªç ´': 'ğŸš€',
      'çºªå¿µæ´»åŠ¨': 'ğŸ•¯ï¸', 'è¿½æ‚¼': 'ğŸ•¯ï¸', 'çºªå¿µæ—¥': 'ğŸ•¯ï¸',
      'ç¤¾ä¼šäº‹ä»¶': 'ğŸ“¢'
    };
    
    // æŸ¥æ‰¾åŒ¹é…çš„æ ‡ç­¾å›¾æ ‡
    for (const tag of topic.tags || []) {
      if (tagIcons[tag]) return tagIcons[tag];
    }
    
    // æ ¹æ®æ¨¡æ¿ç±»å‹è¿”å›é»˜è®¤å›¾æ ‡
    if (topic.template?.slug === 'breaking') return 'ğŸš¨';
    if (topic.template?.slug === 'national') return 'ğŸŠ';
    if (topic.template?.slug === 'timeline') return 'â°';
    
    return 'ğŸ“¢'; // é»˜è®¤å›¾æ ‡
  };

  return (
    <div className={`${cardStyles[variant]} p-6 transition-all duration-200`}>
      {/* ä¸“é¢˜æ ‡è¯† */}
      <div className="flex items-center justify-between mb-3">
        <div className="flex items-center space-x-2">
          <span className="text-2xl">{getTopicIcon(topic)}</span>
          {topic.is_breaking && (
            <span className="px-2 py-1 bg-red-500 text-white text-xs font-bold rounded-full animate-pulse">
              çªå‘
            </span>
          )}
        </div>
      </div>

      {/* æ ‡é¢˜å’Œæ‘˜è¦ */}
      <h3 className="text-xl font-bold mb-2 line-clamp-2 hover:text-blue-600">
        <Link href={`/topic/${topic.slug}`}>
          {topic.title}
        </Link>
      </h3>
      
      {topic.summary && (
        <p className="text-gray-600 text-sm mb-4 line-clamp-3">
          {topic.summary}
        </p>
      )}
    </div>
  );
};
```

## âš™ï¸ ä¸šåŠ¡æµç¨‹è®¾è®¡

### ä¸“é¢˜ç”Ÿå‘½å‘¨æœŸç®¡ç†æµç¨‹

#### ä¸“é¢˜åˆ›å»ºæµç¨‹

```mermaid
flowchart TD
    A[äº‹ä»¶ç›‘æµ‹] --> B{äº‹ä»¶è¯„ä¼°}
    B -->|é‡å¤§äº‹ä»¶| C[å¿«é€Ÿå“åº”åˆ›å»º]
    B -->|é¢„å®šæ´»åŠ¨| D[æå‰è§„åˆ’åˆ›å»º]
    B -->|ä¸€èˆ¬äº‹ä»¶| E[ä¸åˆ›å»ºä¸“é¢˜]
    
    C --> F[æŒ‡å®šä¸“é¢˜ç¼–è¾‘]
    D --> F
    
    F --> G[å¡«å†™åŸºæœ¬ä¿¡æ¯]
    G --> H[è®¾ç½®ä¸“é¢˜ç±»å‹]
    H --> I[é…ç½®æƒé™å’ŒçŠ¶æ€]
    I --> J[å‘å¸ƒä¸“é¢˜é¡µé¢]
    
    J --> K[ç›‘æ§äº‹ä»¶å‘å±•]
    K --> L[æ›´æ–°å†…å®¹å’Œæ—¶é—´çº¿]
    L --> M{äº‹ä»¶ç»“æŸ?}
    M -->|å¦| K
    M -->|æ˜¯| N[ä¸“é¢˜å½’æ¡£]
    
    style C fill:#ff9999,stroke:#333,stroke-width:2px
    style F fill:#ff9999,stroke:#333,stroke-width:2px
    style J fill:#ff9999,stroke:#333,stroke-width:2px
```

#### çªå‘äº‹ä»¶å“åº”æµç¨‹

```mermaid
sequenceDiagram
    participant Monitor as äº‹ä»¶ç›‘æµ‹
    participant Editor as å€¼ç­ç¼–è¾‘
    participant System as ä¸“é¢˜ç³»ç»Ÿ
    participant CMS as å†…å®¹ç®¡ç†
    participant Frontend as å‰ç«¯å±•ç¤º
    
    Monitor->>Editor: çªå‘äº‹ä»¶é€šçŸ¥
    Editor->>System: ç´§æ€¥åˆ›å»ºä¸“é¢˜
    System->>System: è‡ªåŠ¨ç”ŸæˆåŸºç¡€ä¿¡æ¯
    Editor->>CMS: å‘å¸ƒå¿«è®¯æ–‡ç« 
    CMS->>System: å…³è”æ–‡ç« åˆ°ä¸“é¢˜
    System->>Frontend: å®æ—¶æ›´æ–°ä¸“é¢˜é¡µé¢
    
    loop æŒç»­è·Ÿè¸ª
        Editor->>System: æ›´æ–°æ—¶é—´çº¿äº‹ä»¶
        Editor->>CMS: å‘å¸ƒåç»­æŠ¥é“
        System->>Frontend: æ¨é€æ›´æ–°é€šçŸ¥
    end
    
    Editor->>System: æ ‡è®°äº‹ä»¶ç»“æŸ
    System->>System: è‡ªåŠ¨å½’æ¡£ä¸“é¢˜
```

## ğŸš€ éƒ¨ç½²å’Œè¿ç»´è®¾è®¡

### å®¹å™¨åŒ–éƒ¨ç½²æ¶æ„

#### Dockerå®¹å™¨é…ç½®

```dockerfile
# åç«¯Djangoå®¹å™¨
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    postgresql-client \
    redis-tools \
    nginx \
    && rm -rf /var/lib/apt/lists/*

# å®‰è£…Pythonä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV DJANGO_SETTINGS_MODULE=config.settings.production
ENV PYTHONPATH=/app

# å¯åŠ¨è„šæœ¬
COPY scripts/start.sh /start.sh
RUN chmod +x /start.sh

EXPOSE 8000
CMD ["/start.sh"]
```

### æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦

#### ç›‘æ§æŒ‡æ ‡ä½“ç³»

```python
# monitoring/metrics.py
from prometheus_client import Counter, Histogram, Gauge
import time
import functools

# ä¸“é¢˜ç³»ç»Ÿç›‘æ§æŒ‡æ ‡
TOPIC_REQUESTS = Counter(
    'topic_requests_total',
    'ä¸“é¢˜è¯·æ±‚æ€»æ•°',
    ['method', 'endpoint', 'status']
)

TOPIC_REQUEST_DURATION = Histogram(
    'topic_request_duration_seconds',
    'ä¸“é¢˜è¯·æ±‚å¤„ç†æ—¶é—´',
    ['endpoint']
)

ACTIVE_TOPICS = Gauge(
    'active_topics_count',
    'æ´»è·ƒä¸“é¢˜æ•°é‡'
)

def monitor_endpoint(endpoint_name):
    """ç›‘æ§APIç«¯ç‚¹çš„è£…é¥°å™¨"""
    def decorator(func):
        @functools.wraps(func)
        def wrapper(request, *args, **kwargs):
            start_time = time.time()
            try:
                response = func(request, *args, **kwargs)
                TOPIC_REQUESTS.labels(
                    method=request.method,
                    endpoint=endpoint_name,
                    status=response.status_code
                ).inc()
                return response
            finally:
                duration = time.time() - start_time
                TOPIC_REQUEST_DURATION.labels(endpoint=endpoint_name).observe(duration)
        return wrapper
    return decorator
```

### æµ‹è¯•ç­–ç•¥

#### å•å…ƒæµ‹è¯•

```python
# tests/test_topic_models.py
import pytest
from django.test import TestCase
from django.core.exceptions import ValidationError
from news.models import Topic, TopicTimeline

class TopicModelTests(TestCase):
    """ä¸“é¢˜æ¨¡å‹æµ‹è¯•"""
    
    def setUp(self):
        self.topic_data = {
            'title': 'æµ‹è¯•ä¸“é¢˜',
            'slug': 'test-topic',
            'importance_level': 'national',
            'status': 'ongoing',
            'is_breaking': True,
            'priority_weight': 2000
        }
    
    def test_create_topic(self):
        """æµ‹è¯•åˆ›å»ºä¸“é¢˜"""
        topic = Topic.objects.create(**self.topic_data)
        
        assert topic.title == 'æµ‹è¯•ä¸“é¢˜'
        assert topic.slug == 'test-topic'
        assert topic.is_breaking is True
        assert topic.status == 'ongoing'
        
    def test_topic_slug_unique(self):
        """æµ‹è¯•ä¸“é¢˜slugå”¯ä¸€æ€§"""
        Topic.objects.create(**self.topic_data)
        
        with pytest.raises(ValidationError):
            duplicate_topic = Topic(**self.topic_data)
            duplicate_topic.full_clean()
```

#### é›†æˆæµ‹è¯•

```python
# tests/test_topic_api.py
from rest_framework.test import APITestCase
from rest_framework import status
from django.contrib.auth.models import User, Group
from news.models import Topic

class TopicAPITests(APITestCase):
    """ä¸“é¢˜APIé›†æˆæµ‹è¯•"""
    
    def setUp(self):
        # åˆ›å»ºæµ‹è¯•ç”¨æˆ·å’Œæƒé™ç»„
        self.admin_user = User.objects.create_user(
            username='admin',
            password='testpass'
        )
        admin_group = Group.objects.create(name='TopicAdmins')
        self.admin_user.groups.add(admin_group)
        
        # åˆ›å»ºæµ‹è¯•ä¸“é¢˜
        self.topic = Topic.objects.create(
            title='æµ‹è¯•ä¸“é¢˜',
            slug='test-topic',
            importance_level='national',
            is_active=True
        )
        # æ·»åŠ æµ‹è¯•æ ‡ç­¾
        self.topic.tags.add('çªå‘äº‹ä»¶', 'æµ‹è¯•')
    
    def test_topic_list_api(self):
        """æµ‹è¯•ä¸“é¢˜åˆ—è¡¨API"""
        url = '/api/topics/'
        response = self.client.get(url)
        
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        self.assertEqual(len(response.data['results']), 1)
        self.assertEqual(response.data['results'][0]['slug'], 'test-topic')
```

---

## ğŸ“‹ é¡¹ç›®æ€»ç»“

### è®¾è®¡æ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥

æœ¬è®¾è®¡æ–‡æ¡£æ¶µç›–äº†ä¸“é¢˜ç³»ç»Ÿçš„ä»¥ä¸‹å…³é”®æ–¹é¢ï¼š

âœ… **ç³»ç»Ÿæ¶æ„è®¾è®¡** - å®Œæ•´çš„å‰åç«¯æ¶æ„å’ŒæŠ€æœ¯é€‰å‹  
âœ… **æ•°æ®åº“è®¾è®¡** - è¯¦ç»†çš„ERå›¾å’Œæ¨¡å‹è®¾è®¡  
âœ… **APIæ¥å£è®¾è®¡** - RESTful APIè§„èŒƒå’Œæ€§èƒ½ä¼˜åŒ–  
âœ… **å‰ç«¯UIè®¾è®¡** - å“åº”å¼è®¾è®¡å’Œç»„ä»¶åŒ–æ¶æ„  
âœ… **ä¸šåŠ¡æµç¨‹è®¾è®¡** - å®Œæ•´çš„ä¸“é¢˜ç”Ÿå‘½å‘¨æœŸç®¡ç†  
âœ… **éƒ¨ç½²è¿ç»´è®¾è®¡** - å®¹å™¨åŒ–éƒ¨ç½²å’Œç›‘æ§å‘Šè­¦  
âœ… **æµ‹è¯•ç­–ç•¥** - å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•  

### å®æ–½è·¯çº¿å›¾

#### ç¬¬ä¸€é˜¶æ®µï¼ˆ1-2ä¸ªæœˆï¼‰ï¼šåŸºç¡€åŠŸèƒ½
- [ ] æ•°æ®æ¨¡å‹å®ç°å’Œè¿ç§»
- [ ] æ ¸å¿ƒAPIæ¥å£å¼€å‘  
- [ ] åŸºç¡€å‰ç«¯é¡µé¢å¼€å‘
- [ ] ä¸“é¢˜CRUDåŠŸèƒ½å®ç°

#### ç¬¬äºŒé˜¶æ®µï¼ˆ3-4ä¸ªæœˆï¼‰ï¼šé«˜çº§åŠŸèƒ½  
- [ ] æ—¶é—´çº¿åŠŸèƒ½å¼€å‘
- [ ] æƒé™ç®¡ç†ç³»ç»Ÿå®ç°
- [ ] å†…å®¹èšåˆç®—æ³•ä¼˜åŒ–
- [ ] æ€§èƒ½ç›‘æ§ç³»ç»Ÿæ­å»º

#### ç¬¬ä¸‰é˜¶æ®µï¼ˆ5-6ä¸ªæœˆï¼‰ï¼šç”Ÿäº§ä¼˜åŒ–
- [ ] ç¼“å­˜ä¼˜åŒ–å’ŒCDNéƒ¨ç½²
- [ ] ç›‘æ§å‘Šè­¦ç³»ç»Ÿå®Œå–„
- [ ] è‡ªåŠ¨åŒ–æµ‹è¯•å’ŒCI/CD
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### å…³é”®æˆåŠŸå› ç´ 

1. **æ¶æ„åˆç†æ€§** - åˆ†å±‚æ¸…æ™°ã€æ¨¡å—è§£è€¦ã€æ˜“äºç»´æŠ¤
2. **æ€§èƒ½ä¼˜åŒ–** - å¤šå±‚ç¼“å­˜ã€æ•°æ®åº“ä¼˜åŒ–ã€CDNåŠ é€Ÿ
3. **å®‰å…¨ä¿éšœ** - æƒé™æ§åˆ¶ã€æ•°æ®éªŒè¯ã€ç›‘æ§å‘Šè­¦
4. **è¿ç»´è‡ªåŠ¨åŒ–** - å®¹å™¨åŒ–éƒ¨ç½²ã€æŒç»­é›†æˆã€å¥åº·ç›‘æ§
5. **å›¢é˜Ÿåä½œ** - æ–‡æ¡£è§„èŒƒã€ä»£ç å®¡æŸ¥ã€çŸ¥è¯†åˆ†äº«

---

**æ–‡æ¡£ç‰ˆæœ¬**: v3.0  
**æœ€åæ›´æ–°**: 2025å¹´9æœˆ28æ—¥  
**æ–‡æ¡£ç±»å‹**: è¯¦ç»†è®¾è®¡æ–‡æ¡£  
**ç»´æŠ¤å›¢é˜Ÿ**: å…šæŠ¥å¤´æ¡æŠ€æœ¯å¼€å‘ç»„  
**è”ç³»æ–¹å¼**: å†…éƒ¨æŠ€æœ¯ç¾¤ æˆ– æäº¤Issueåˆ°é¡¹ç›®ä»“åº“

### ç‰ˆæœ¬æ›´æ–°è®°å½•
- **v3.0** (2025-09-28): é‡å¤§æ¶æ„è°ƒæ•´ - ç§»é™¤topic_typeå­—æ®µï¼Œå¢åŠ ä¸“é¢˜æ¨¡æ¿ç³»ç»Ÿï¼Œå¼ºè°ƒä¸Wagtail CMSæ·±åº¦é›†æˆ
- **v2.0** (2025-09-28): å®Œæ•´çš„æŠ€æœ¯è®¾è®¡æ–‡æ¡£ï¼ŒåŒ…å«æ¶æ„è®¾è®¡ã€æ•°æ®æ¨¡å‹ã€APIè®¾è®¡ç­‰
- **v1.0** (2025-09-28): åˆç‰ˆè®¾è®¡æ–‡æ¡£

> ğŸ¯ **è®¾è®¡ç†å¿µ**: æœ¬è®¾è®¡æ–‡æ¡£åŸºäºç°æœ‰Wagtail CMSæ¶æ„ï¼Œéµå¾ª"å¤ç”¨æˆåŠŸæ¨¡å¼ã€æ¸è¿›å¼å¢å¼º"çš„åŸåˆ™ã€‚ä¸“é¢˜ç³»ç»Ÿä¸æ˜¯ç‹¬ç«‹ç³»ç»Ÿï¼Œè€Œæ˜¯å¯¹ç°æœ‰CMSçš„åŠŸèƒ½å¢å¼ºï¼Œç‰¹åˆ«æ˜¯å¤ç”¨äº†Channelæ¨¡æ¿ç³»ç»Ÿçš„æˆåŠŸç»éªŒï¼Œç¡®ä¿æ¶æ„ä¸€è‡´æ€§å’Œç»´æŠ¤ä¾¿åˆ©æ€§ã€‚