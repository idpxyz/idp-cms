# éƒ¨ç½²æŒ‡å—ï¼šå›¾ç‰‡å¤„ç†ç³»ç»Ÿæ›´æ–°

## ğŸ“‹ æ›´æ–°æ¸…å•

æœ¬æ¬¡æ›´æ–°åŒ…å«ä»¥ä¸‹æ”¹è¿›ï¼š

### åç«¯æ”¹è¿›
- âœ… æ–‡ç« æ¨¡å‹æ–°å¢è‡ªåŠ¨æå–æ­£æ–‡å›¾ç‰‡åŠŸèƒ½
- âœ… Wagtail ç®¡ç†ç•Œé¢æ–°å¢å°é¢å›¾ç‰‡æç¤º
- âœ… æ·»åŠ  beautifulsoup4 ä¾èµ–

### å‰ç«¯æ”¹è¿›
- âœ… æœ¬åœ°é»˜è®¤å°é¢å›¾ç‰‡ç³»ç»Ÿï¼ˆæ›¿ä»£å¤–éƒ¨ picsumï¼‰
- âœ… ä¼˜åŒ–å›¾ç‰‡æ˜¾ç¤ºé€»è¾‘
- âœ… ç»Ÿä¸€è§†è§‰é£æ ¼

### æ–°å¢æ–‡ä»¶
- âœ… 13 ä¸ªåˆ†ç±»çš„é»˜è®¤å°é¢ SVG å›¾ç‰‡
- âœ… é»˜è®¤å°é¢ç”Ÿæˆè„šæœ¬

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. å®‰è£…æ–°ä¾èµ–

```bash
cd /opt/idp-cms
pip install beautifulsoup4>=4.12.0
```

æˆ–è€…é‡æ–°å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š

```bash
pip install -r requirements.txt
```

### 2. ç”Ÿæˆé»˜è®¤å°é¢å›¾ç‰‡

```bash
cd /opt/idp-cms
python3 scripts/generate_default_covers.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
æ­£åœ¨ç”Ÿæˆé»˜è®¤å°é¢å›¾ç‰‡åˆ°: /opt/idp-cms/sites/public/images/default-covers
âœ“ å·²ç”Ÿæˆ: default.svg
âœ“ å·²ç”Ÿæˆ: politics.svg
âœ“ å·²ç”Ÿæˆ: economy.svg
...
æˆåŠŸç”Ÿæˆ 13 ä¸ªé»˜è®¤å°é¢å›¾ç‰‡!
```

### 3. æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶

```bash
ls -lh sites/public/images/default-covers/
```

åº”è¯¥çœ‹åˆ° 13 ä¸ª SVG æ–‡ä»¶ã€‚

### 4. å‰ç«¯æ„å»ºï¼ˆå¦‚æœä½¿ç”¨ Next.jsï¼‰

```bash
cd /opt/idp-cms/sites
npm install  # å¦‚æœæœ‰æ–°çš„ä¾èµ–
npm run build
```

### 5. é‡å¯æœåŠ¡

**å¼€å‘ç¯å¢ƒ**ï¼š
```bash
# Django
python manage.py runserver

# Next.js
cd sites && npm run dev
```

**ç”Ÿäº§ç¯å¢ƒ**ï¼š
```bash
# é‡å¯ Django/Gunicorn
systemctl restart idp-cms

# é‡å¯ Next.js (å¦‚æœå•ç‹¬éƒ¨ç½²)
pm2 restart idp-cms-frontend
```

---

## âœ… éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥åç«¯

è®¿é—® Wagtail ç®¡ç†ç•Œé¢ï¼Œåˆ›å»ºæˆ–ç¼–è¾‘ä¸€ç¯‡æ–‡ç« ï¼š

1. æ‰“å¼€æ–‡ç« ç¼–è¾‘é¡µé¢
2. æŸ¥çœ‹"å°é¢å›¾ç‰‡"å­—æ®µä¸Šæ–¹æ˜¯å¦æœ‰é»„è‰²æç¤ºæ¡†
3. å°è¯•ä¸ä¸Šä¼ å°é¢ï¼Œç›´æ¥åœ¨æ­£æ–‡æ’å…¥å›¾ç‰‡
4. ä¿å­˜å¹¶å‘å¸ƒ
5. æŸ¥çœ‹å‰ç«¯æ˜¯å¦æ­£ç¡®æ˜¾ç¤ºå›¾ç‰‡

### 2. æ£€æŸ¥å‰ç«¯

è®¿é—®ç½‘ç«™é¦–é¡µï¼š

1. æŸ¥çœ‹æ–‡ç« åˆ—è¡¨ä¸­çš„å›¾ç‰‡
2. å¯¹äºæ²¡æœ‰å°é¢çš„æ–‡ç« ï¼Œåº”æ˜¾ç¤ºå¯¹åº”åˆ†ç±»çš„é»˜è®¤å°é¢
3. æ£€æŸ¥å›¾ç‰‡åŠ è½½é€Ÿåº¦ï¼ˆåº”æ¯”ä¹‹å‰æ›´å¿«ï¼‰
4. ç¡®è®¤æ²¡æœ‰å›¾ç‰‡åŠ è½½å¤±è´¥æˆ–æ˜¾ç¤ºé”™ä¹±

### 3. æ£€æŸ¥é»˜è®¤å°é¢

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
```
http://your-domain/images/default-covers/default.svg
http://your-domain/images/default-covers/tech.svg
http://your-domain/images/default-covers/sports.svg
```

åº”è¯¥èƒ½çœ‹åˆ°å½©è‰²æ¸å˜çš„ SVG å›¾ç‰‡ã€‚

### 4. æµ‹è¯•ä¸‰ç§åœºæ™¯

**åœºæ™¯ 1ï¼šæœ‰å°é¢çš„æ–‡ç« **
- åˆ›å»ºæ–‡ç«  â†’ ä¸Šä¼ å°é¢å›¾ç‰‡ â†’ å‘å¸ƒ
- é¦–é¡µåº”æ˜¾ç¤ºä¸Šä¼ çš„å°é¢

**åœºæ™¯ 2ï¼šæ— å°é¢ä½†æ­£æ–‡æœ‰å›¾ç‰‡**
- åˆ›å»ºæ–‡ç«  â†’ ä¸ä¸Šä¼ å°é¢ â†’ åœ¨æ­£æ–‡æ’å…¥å›¾ç‰‡ â†’ å‘å¸ƒ
- é¦–é¡µåº”æ˜¾ç¤ºæ­£æ–‡çš„ç¬¬ä¸€å¼ å›¾ç‰‡

**åœºæ™¯ 3ï¼šæ— å°é¢ä¹Ÿæ— æ­£æ–‡å›¾ç‰‡**
- åˆ›å»ºæ–‡ç«  â†’ ä¸ä¸Šä¼ å°é¢ â†’ æ­£æ–‡åªæœ‰æ–‡å­— â†’ å‘å¸ƒ
- é¦–é¡µåº”æ˜¾ç¤ºå¯¹åº”åˆ†ç±»çš„é»˜è®¤å°é¢ï¼ˆä¾‹å¦‚"ç§‘æŠ€"æ–‡ç« æ˜¾ç¤ºç´«è‰² ğŸ’» å›¾æ ‡ï¼‰

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ï¼šé»˜è®¤å°é¢å›¾ç‰‡ä¸æ˜¾ç¤º

**å¯èƒ½åŸå› **ï¼š
1. å›¾ç‰‡æœªç”Ÿæˆ
2. è·¯å¾„ä¸æ­£ç¡®
3. é™æ€æ–‡ä»¶æœªæ­£ç¡®é…ç½®

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls sites/public/images/default-covers/

# 2. é‡æ–°ç”Ÿæˆ
python3 scripts/generate_default_covers.py

# 3. æ£€æŸ¥ Next.js é™æ€æ–‡ä»¶é…ç½®
# ç¡®ä¿ sites/public/images ç›®å½•å¯ä»¥è¢«è®¿é—®
```

### é—®é¢˜ï¼šbeautifulsoup4 å¯¼å…¥é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
ModuleNotFoundError: No module named 'bs4'
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
pip install beautifulsoup4
```

### é—®é¢˜ï¼šè‡ªåŠ¨æå–å›¾ç‰‡å¤±è´¥

**æ£€æŸ¥æ—¥å¿—**ï¼š
```bash
# æŸ¥çœ‹ Django æ—¥å¿—
tail -f logs/django.log

# æŸ¥æ‰¾ç›¸å…³è­¦å‘Š
grep "æå–æ–‡ç« .*æ­£æ–‡å›¾ç‰‡æ—¶å‡ºé”™" logs/django.log
```

**å¸¸è§åŸå› **ï¼š
- æ­£æ–‡ä¸­çš„å›¾ç‰‡ä¸æ˜¯ Wagtail ç®¡ç†çš„å›¾ç‰‡ï¼ˆå¤–éƒ¨å›¾ç‰‡é“¾æ¥ï¼‰
- HTML æ ¼å¼å¼‚å¸¸

### é—®é¢˜ï¼šå‰ç«¯ä»ç„¶æ˜¾ç¤º Picsum å›¾ç‰‡

**æ£€æŸ¥æ­¥éª¤**ï¼š
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
2. æ£€æŸ¥ `sites/lib/utils/placeholderImages.ts` ä¸­çš„é…ç½®
3. é‡æ–°æ„å»ºå‰ç«¯ï¼š`npm run build`
4. æ£€æŸ¥ localStorage ç¼“å­˜ï¼šæ¸…ç©ºæˆ–ç­‰å¾…è¿‡æœŸï¼ˆ5åˆ†é’Ÿï¼‰

---

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

å¦‚æœæ›´æ–°å‡ºç°é—®é¢˜ï¼Œå¯ä»¥å›æ»šï¼š

### Git å›æ»š

```bash
cd /opt/idp-cms
git log --oneline -n 5  # æŸ¥çœ‹æœ€è¿‘çš„æäº¤
git revert <commit-hash>  # å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬
```

### æ‰‹åŠ¨å›æ»š

1. ä» requirements.txt ç§»é™¤ beautifulsoup4
2. æ¢å¤ `apps/news/models/article.py` çš„æ—§ç‰ˆæœ¬
3. æ¢å¤ `sites/lib/utils/placeholderImages.ts` çš„æ—§ç‰ˆæœ¬
4. åˆ é™¤ `sites/public/images/default-covers/` ç›®å½•
5. é‡å¯æœåŠ¡

---

## ğŸ“Š ç›‘æ§å»ºè®®

### å…³é”®æŒ‡æ ‡

éƒ¨ç½²åï¼Œç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š

1. **å›¾ç‰‡åŠ è½½é€Ÿåº¦**
   - é¦–é¡µ LCP (Largest Contentful Paint) åº”æœ‰æ‰€æ”¹å–„
   - é»˜è®¤å°é¢ SVG åŠ è½½æ—¶é—´ < 10ms

2. **é”™è¯¯æ—¥å¿—**
   - ç›‘æ§æ˜¯å¦æœ‰å›¾ç‰‡æå–ç›¸å…³çš„é”™è¯¯
   - æ£€æŸ¥æ˜¯å¦æœ‰ 404 é”™è¯¯ï¼ˆé»˜è®¤å°é¢å›¾ç‰‡ï¼‰

3. **ç”¨æˆ·ä½“éªŒ**
   - é¦–é¡µæ–‡ç« å¡ç‰‡æ˜¯å¦éƒ½æœ‰å›¾ç‰‡
   - å›¾ç‰‡åŠ è½½æ˜¯å¦æµç•…
   - æ˜¯å¦æœ‰è§†è§‰æ··ä¹±

### ç›‘æ§å‘½ä»¤

```bash
# æ£€æŸ¥ Django æ—¥å¿—ä¸­çš„å›¾ç‰‡ç›¸å…³é”™è¯¯
tail -f logs/django.log | grep -i "image\|cover\|å›¾ç‰‡"

# æ£€æŸ¥ Nginx è®¿é—®æ—¥å¿—ä¸­çš„é»˜è®¤å°é¢è®¿é—®
tail -f /var/log/nginx/access.log | grep "default-covers"

# ç»Ÿè®¡é»˜è®¤å°é¢ä½¿ç”¨æƒ…å†µ
grep "default-covers" /var/log/nginx/access.log | wc -l
```

---

## ğŸ“ æ›´æ–°è®°å½•

**æ›´æ–°æ—¥æœŸ**ï¼š2025-10-20

**ç‰ˆæœ¬**ï¼šv1.0

**å½±å“èŒƒå›´**ï¼š
- åç«¯ï¼šæ–‡ç« æ¨¡å‹ã€Wagtail ç®¡ç†ç•Œé¢
- å‰ç«¯ï¼šå›¾ç‰‡æ˜¾ç¤ºç»„ä»¶ã€å ä½å›¾ç‰‡ç³»ç»Ÿ
- ä¾èµ–ï¼šæ–°å¢ beautifulsoup4

**å…¼å®¹æ€§**ï¼š
- âœ… å‘åå…¼å®¹ï¼Œç°æœ‰æ–‡ç« ä¸å—å½±å“
- âœ… æ— éœ€æ•°æ®åº“è¿ç§»
- âœ… æ— éœ€ä¿®æ”¹ç°æœ‰ API

**æ€§èƒ½å½±å“**ï¼š
- âœ… æ­£é¢å½±å“ï¼šæœ¬åœ°å›¾ç‰‡åŠ è½½æ›´å¿«
- âœ… æ­£é¢å½±å“ï¼šæ— å¤–éƒ¨ä¾èµ–ï¼Œæ›´ç¨³å®š
- âš ï¸ è½»å¾®å½±å“ï¼šä¿å­˜æ–‡ç« æ—¶éœ€æå–å›¾ç‰‡ï¼ˆä¸€æ¬¡æ€§æ“ä½œï¼‰

---

## ğŸ‰ éƒ¨ç½²å®Œæˆ

å¦‚æœæ‰€æœ‰éªŒè¯æ­¥éª¤éƒ½é€šè¿‡ï¼Œæ­å–œä½ æˆåŠŸéƒ¨ç½²äº†å›¾ç‰‡å¤„ç†ç³»ç»Ÿæ›´æ–°ï¼

**ä¸‹ä¸€æ­¥**ï¼š
1. é€šçŸ¥ç¼–è¾‘å›¢é˜Ÿæ–°åŠŸèƒ½
2. ç›‘æ§å‡ å¤©ç¡®ä¿ç¨³å®š
3. å¯é€‰ï¼šä¸ºç°æœ‰æ–‡ç« æ‰¹é‡æå–å°é¢å›¾ç‰‡

**éœ€è¦å¸®åŠ©ï¼Ÿ**
- æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š`docs/å›¾ç‰‡å¤„ç†æ–¹æ¡ˆ.md`
- å¿«é€Ÿå¼€å§‹ï¼š`docs/QUICK_START_å›¾ç‰‡å¤„ç†.md`


