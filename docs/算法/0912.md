下面是“今日头条、最热阅读、编辑推荐”三大板块的整体解决方案（对标头条系实践），覆盖信号、聚类、排序、多样性、接口、缓存与观测，便于直接落地实施。

- 目标与原则
  - 强一致入口、后端聚合、前端轻逻辑。
  - 多信号融合、时效优先，跨源去重与多样性约束。
  - 可观测、可灰度、可回滚。

- 数据与特征
  - 文章级多窗口信号：1h/6h/24h 热度、CTR、停留、分享/评论、来源质量分、时间衰减（6–12h 半衰期）。
  - 聚类级特征：簇内均值/方差（pop_1h/pop_24h/ctr_1h/quality/recency）、来源数量、实体覆盖度。
  - 趋势：1h/24h 比值+增速阈值+新鲜度。

- 话题聚类
  - URL 精确聚合 + 标题相似度聚类（已实现，阈值可按模块微调）。
  - 输出代表文与 `topic_slug`，为跨模块去重与跳转统一锚点。
  - 融合聚类级指标（已加）。

- 排序与多样性
  - 多路召回：热点、相似、协同、关注主题。
  - 统一重排：融合分（文档/聚类）+ MMR（与多样性目标的距离），并加规则约束：
    - 来源/频道/作者上限；同簇限额（头条1，最热1–2）。
    - 时间窗分层（1h/6h/24h）抽样混排避免“老热榜”。

- 模块策略
  - 今日头条
    - 目标：强时效+爆发，2–4 条位。
    - 排序：爆发度（1h/24h 比+增速）× 质量 × 新鲜度；强多样性约束。
    - 数据：直接使用话题簇代表文（避免同题多条）。
    - 缓存：s-maxage 30–60s + SWR；首条可更激进（15–30s）。
  - 最热阅读
    - 目标：稳定热度，时效衰减显著，覆盖更广。
    - 排序：热度（PV/UV/停留/互动）× 衰减；跨频道/来源配额；同簇<=2。
    - 分桶：1h/6h/24h 采样混排，避免滞留。
    - 缓存：s-maxage 60–120s + SWR。
  - 编辑推荐
    - 目标：人编质量与品牌位；避免陈旧与同质。
    - 策略：精选:热度=4:2 或 3:1 混排；内容时效上限（如72h），过期降权。
    - 兜底：精选位为空时回退高质热榜。
    - 缓存：s-maxage 5–10 分钟；支持排期。

- 接口设计（后端）
  - 统一参数：size（默认8）、hours、region、lang、cursor、diversity（low/med/high）、exclude_cluster_ids、fields、debug。
  - 统一返回：{ items: [], next_cursor, debug }；items 含 id、slug、title、final_score、trend、cluster_slug、source、channel、publish_at。
  - 具体接口：
    - /api/topics：话题榜（已增强：聚类指标、趋势、cursor、region/lang）。
    - /api/headlines：头条专用，返回簇代表文，爆发度优先，slots=2–4。
      - 入参：size（默认4，范围1–6）、hours（默认24，范围1–72）、region、lang、diversity、exclude_cluster_ids、fields、debug。
      - 排序：爆发度（1h/24h 比值+增速）× 质量 × 新鲜度；强多样性与同簇唯一约束。
      - 返回：{ items: [{ id, slug, title, cluster_slug, trend, source, channel, publish_at, final_score }], next_cursor?（可选）, debug? }
      - 缓存建议：s-maxage 30–60s + SWR；首条位可 15–30s。
    - /api/hot：最热阅读，强时间衰减与分桶混排；支持游标。
      - 入参：size（默认10，范围1–50）、hours（默认168，范围24–720）、buckets（"1h,6h,24h"）、region、lang、diversity、exclude_cluster_ids、fields、cursor、debug。
      - 排序：热度（PV/UV/停留/互动）× 衰减；跨频道/来源配额；同簇<=2；分桶混排避免老热固化。
      - 返回：{ items: [{ id, slug, title, cluster_slug, source, channel, publish_at, final_score }], next_cursor, debug? }
      - 缓存建议：s-maxage 60–120s + SWR。
  - 稳定排序+游标：服务端稳定排序，cursor 为 offset 或 opaque token，避免重复/抖动。

  - 字段说明：
    - final_score：融合分（文档/聚类）用于排序，可灰度调整权重。
    - cluster_slug：话题簇标识，跨模块去重与话题页跳转锚点。
    - trend：up/down/stable，依据 1h vs 24h 与新鲜度判定。
    - debug：仅灰度/内网使用，包含各信号分与权重，生产需关闭。

- 前端接入
  - 模块消费统一结构；骨架屏与空态保留。
  - 跨模块去重：使用 `cluster_slug` 在“头条/推荐/最热”间去重（保留优先级：头条 > 推荐 > 最热）。
    - 建议策略：先渲染头条，记录 seen_clusters；在推荐与最热过滤同簇；同簇最多保留2条且不同来源。
  - 支持 region/lang 透传；支持加载更多使用 next_cursor。
  - 链接统一：话题跳转 `/portal/topic/[slug]`。

- 缓存与性能
  - CDN：短 s-maxage + SWR；热门接口启用后台预热。
  - 服务端：Redis 层缓存聚合结果（以 site/region/lang/hours/slot 为 key，TTL 30–120s）。
  - 端点建议：
    - /api/headlines：30–60s；首条 15–30s；预热首屏。
    - /api/hot：60–120s；预热前两页游标。
    - /api/topics：60s；列表翻页使用 next_cursor。
  - 超时/熔断：上游ES/DB 6–8s 超时；降级返回最小可用数据（非空列表）。

- 质量与风控
  - 来源质量分、黑白名单；异常流量与机器人过滤。
  - 旧闻压制、重复合并、标题党降权、敏感内容识别（NSFW/政治等按站点策略）。

- 观测与AB
  - 指标：曝光、CTR、停留、分享、空列表率、降级率、P95、错误率、去重率、多样性得分。
  - AB/灰度：开关与策略参数（权重、阈值、比例）可灰度；逐步放量。
  - 日志：debug 字段可选返回（仅内网/灰度），生产关闭。
  - 目标阈值（首版建议）：
    - 空列表率 < 1%；接口 P95 < 400ms（内网场景），错误率 < 0.5%。
    - 去重率（跨模块同簇）> 85%；多样性（来源/频道覆盖）达预设配额。
    - 首页头条 CTR 较基线 +10%（AB 观察 3–7 天）。

- 上线路径
  - Phase 1：后端补齐 /api/headlines、/api/hot；将今日头条/最热改走新接口，保持 topics 不变。
  - Phase 2：启用去重与多样性约束；打开 region/lang；观察指标。
  - Phase 3：引入多路召回与轻量 Ranker；AB 权重；扩大流量。
  - 回滚策略：模块回退到原有简化逻辑；接口保留稳定兼容返回。

- 实现状态（2025-09-12）
  - 已完成：/api/topics 增强（聚类指标、趋势、cursor、region/lang、稳定排序）。
  - 待实现：/api/headlines（爆发优先、强多样性、短缓存）、/api/hot（强衰减、分桶混排、游标）。
  - 前端：TodayHeadlines/MostRead 接入新接口；按 `cluster_slug` 跨模块去重；启用 region/lang 透传；加载更多用 next_cursor。

- 配置与开关（建议）
  - features.headlines.enabled / features.hot.enabled / features.topics.cursor_enabled
  - ranker.weights（各信号权重）、diversity.level、bucket.weights（1h/6h/24h 比例）
  - safeguards.max_per_source / max_per_channel / max_per_cluster
  - logging.debug_enabled（仅灰度环境）

如同意，我可以：
- 先实现 `/api/headlines` 与 `/api/hot` 的后端版本（含 cursor/region/lang/多样性/趋势）；
- 前端将 TodayHeadlines/MostRead 接入新接口并启用跨模块去重；
- 配置指标上报与灰度开关。