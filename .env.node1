# ============================================================================
# 生产环境 - 服务器1（主节点）- 8.133.22.7
# ============================================================================
# 此文件包含节点1特定的配置，会覆盖 .env.core 和 .env.features 中的默认值

# =============================================================================
# 节点基础配置
# =============================================================================
NODE_NAME=node1
NODE_ROLE=primary
SERVER1_IP=8.133.22.7
SERVER2_IP=121.41.73.49

# =============================================================================
# PostgreSQL 数据库配置 (统一为开发环境密码)
# =============================================================================
POSTGRES_HOST=172.28.0.10
POSTGRES_PORT=5432
POSTGRES_DB=news_ha
POSTGRES_USER=news
POSTGRES_PASSWORD=news

# =============================================================================
# Redis 配置 (添加密码保护)
# =============================================================================
REDIS_HOST=172.28.0.20
REDIS_PORT=6379
REDIS_PASSWORD=devredis123
REDIS_URL=redis://:devredis123@172.28.0.20:6379/0

# =============================================================================
# Celery 配置
# =============================================================================
CELERY_BROKER_URL=redis://:devredis123@172.28.0.20:6379/1
CELERY_RESULT_BACKEND=redis://:devredis123@172.28.0.20:6379/1

# =============================================================================
# MinIO 对象存储 (统一为开发环境密码)
# =============================================================================
MINIO_ENDPOINT=http://172.28.0.50:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=idp-media-prod-public
MINIO_PUBLIC_DOMAIN=8.133.22.7:9002
MINIO_USE_SSL=false

# =============================================================================
# ClickHouse 分析数据库 (统一为开发环境密码)
# =============================================================================
CLICKHOUSE_PASSWORD=thends
CLICKHOUSE_URL=clickhouse://default:thends@172.28.0.30:9000/default

# =============================================================================
# OpenSearch 搜索引擎 (安全插件禁用，使用 HTTP)
# =============================================================================
OPENSEARCH_URL=http://172.28.0.40:9200
OPENSEARCH_SECURITY_DISABLED=true

# =============================================================================
# Django 核心配置
# =============================================================================
DJANGO_SECRET_KEY=production-secret-key-please-change-this-to-random-string-2024
DJANGO_DEBUG=0
DJANGO_SETTINGS_MODULE=config.settings.prod
DJANGO_TIME_ZONE=Asia/Shanghai

# =============================================================================
# 应用 URL 配置
# =============================================================================
CMS_PUBLIC_URL=http://8.133.22.7:8000
CMS_ORIGIN=http://authoring:8000
FRONTEND_PUBLIC_URL=http://8.133.22.7:3000
FRONTEND_ORIGIN=http://frontend:3000
BACKEND_PUBLIC_URL=http://8.133.22.7:8000

SITE_HOSTNAME=8.133.22.7
TRACK_URL=http://authoring:8000/api/track
FEED_API_URL=http://authoring:8000

# =============================================================================
# CORS 配置
# =============================================================================
CORS_ALLOWED_ORIGINS=http://8.133.22.7:3000,http://localhost:3000

# =============================================================================
# CSRF 配置
# =============================================================================
CSRF_TRUSTED_ORIGINS=http://8.133.22.7:8000,http://8.133.22.7:3000

# =============================================================================
# 会话配置
# =============================================================================
SESSION_ENGINE=django.contrib.sessions.backends.cache
SESSION_CACHE_ALIAS=default

# =============================================================================
# 安全配置 (HTTP 环境，关闭 SSL 重定向)
# =============================================================================
SECURE_SSL_REDIRECT=False
DJANGO_ALLOWED_HOSTS=*,localhost,127.0.0.1,172.28.1.30,8.133.22.7

# Portal 站点配置
PORTAL_SITE=localhost

# =============================================================================
# API限流配置
# =============================================================================
DISABLE_RATE_LIMIT=1

# Django Base URL（用于图片等媒体文件的公开访问）
DJANGO_BASE_URL=http://8.133.22.7:8000
MEDIA_BASE_URL=http://8.133.22.7:8000
